# DCC++ESP32 PCB
The DCC++ESP32 CS works well with off the shelf components but it doesn't provide a standard design for integrating the components. This PCB is designed to provide a standard board for the DCC++ESP32 project based on the TTGO-T1 ESP32 board since it provides most of the functionality required for the CS as well as exposes almost all pins of the ESP32 MCU. This PCB also provides a few additional features such as an integrated L298 IC for DCC signal generation and native LCC integration.

## PCB Features
The PCB provides two RJ45 jacks and an MCP2551 IC for the LCC integration as well as an onboard L298 IC for DCC signal generation.
In addition to LCC the PCB provides headers for I2C (2x) and a Serial1 (for Nextion or HC12).

## TTGO-T1 Pin usage map
0 : FREE (restrictions apply)
1 : UART0 TX
2 : SD-MISO
3 : UART0 RX
4 : CAN RX
5 : CAN TX
6-11 : NOT AVAILABLE (connected to on chip flash)
12 : FREE (restrictions apply)
13 : SD-CS
14 : SD-CLK
15 : SD-MOSI
16 : OPS DCC ENABLE
17 : OPS DCC SIGNAL
18 : PROG DCC ENABLE
19 : PROG DCC SIGNAL
20 : NOT AVAILABLE
21 : I2C - SCL
22 : ONBOARD LED, possible usage for RGB LED (WS2811 or similar) for CS status.
23 : I2C - SDA
24 : NOT AVAILABLE
25 : Serial1 RX
26 : Serial1 TX
27 : FREE
28-31 : NOT AVAILABLE
32 : FREE
33 : FREE
34 : FREE (INPUT ONLY)
35 : FREE (INPUT ONLY)
SVP (36) : OPS CURRENT SENSE (INPUT ONLY)
37 : NOT AVAILABLE
38 : NOT AVAILABLE
SVP (39) : PROG CURRENT SENSE (INPUT ONLY)

### Using this PCB as a DCC booster
This PCB is designe such that it can be used as a DCC booster PCB when connected to the LCC bus. A set of jumpers can be added to bridge the LCC signal pins to the PROG track. When using the PCB for a booster the DCC signal splitting circuitry should be omitted as the DCC signal will be sourced from the LCC bus instead of being generated by the ESP32, no connection to the DCC bus is required for the booster except for it's own output(s) for a power district.

## PCB Schematic
TBD

## DCC signal strength
The on-board L298 chip can provide up to 2A per output per the datasheet but the DCC++ESP32 code limits this to ~1.75A. This should be sufficient for most scales when using power districts rather than one DCC bus for the entire layout.

## CS Status via RGB LED
Using GPIO 22 it is possible to wire an RGB LED using WS2811 (or similar) to display the CS status, current design considerations are as follows:

LED 1: WiFi status (GREEN = connected, RED = disconnected, YELLOW = connecting)
LED 2: OPS track status (GREEN = NORMAL/ACTIVE/ON, BLACK = OFF, YELLOW = 75% CURRENT DRAW, RED = FAULT)
LED 3: PROG track status (GREEN = NORMAL/ACTIVE/ON, BLACK = OFF, YELLOW = 75% CURRENT DRAW, RED = FAULT)

Additional status LEDs could be added if needed.